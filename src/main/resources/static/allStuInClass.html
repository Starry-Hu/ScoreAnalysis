<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="css/font.css">
    <link rel="stylesheet" href="lib/layui/css/layui.css">
    <script type="text/javascript" src="js/jquery-3.3.1.js"></script>
    <script src="lib/layui/layui.js" charset="utf-8"></script>
    <script type="text/javascript" src="js/admin.js"></script>
    <title>班级学生总况</title>
</head>

<body class="layui-anim layui-anim-up">
<div>
        <span class="layui-breadcrumb">
            <a href="">首页</a>
            <a href="">演示</a>
            <a>
                <cite>导航元素</cite></a>
        </span>
    <a class="layui-btn layui-btn-small" style="float: right;"
       href="javascript:location.replace(location.href);" title="刷新">刷新</a>
</div>
<div>
    <div class="demoTable">
        搜索ID：
        <div class="layui-inline">
            <input class="layui-input" name="id" id="demoReload" autocomplete="off">
        </div>
        <div class="layui-btn" data-type="reload" id="search">搜索</div>
    </div>

    <div>
        <button class="layui-btn layui-btn-danger" onclick="print()"><i class="icon iconfont"></i> 打印表格</button>
        <span class="x-right" style="line-height:40px">共有数据：88 条</span>
    </div>

    <table id="students" lay-filter="test"></table>
</div>

<script type="text/html" id="barDemo">
    <a class="layui-btn layui-btn-sm" lay-event="inform">通知</a>
</script>
<script>
    layui.use('table', function () {
        var table = layui.table;

        //展示已知数据
        table.render({
            elem: '#students',
            url: 'student/getStuInfoByStuClsWithPage?clsId=021101', //数据接口(不需要带项目名)
            parseData: function (res) { //res 即为原始返回的数据
                return {
                    "code": res.code, //解析接口状态
                    "msg": res.msg, //解析提示文本
                    "count": res.data.totalRecord, //解析数据长度
                    "data": res.data.list //解析数据列表
                };
            },
            response: {
                statusCode: 205 //规定成功的状态码，默认：0
            },
            request:{
                pageName: 'pageNum' //页码的参数名称，默认：page
                ,limitName: 'pageSize' //每页数据量的参数名，默认：limit
            },
            cols: [
                [ //标题栏
                    {
                        type: 'numbers'
                    }, {
                    field: 'sid',
                    title: '学号',
                    width: 180,
                    sort: true
                }, {
                    field: 'sname',
                    title: '姓名',
                    width: 180
                }, {
                    field: 'className',
                    title: '班级',
                    width: 180
                }, {
                    field: 'majorName',
                    title: '专业',
                    width: 180
                }, {
                    field: 'undoCourse', //课程id
                    title: '未修课程号',
                    templet: '<div>{{d.undoCourse[0].cid}}</div>',
                    minWidth: 80
                }, {
                    field: 'cname', //课程名称
                    title: '课程名称',
                    templet: '<div>{{d.undoCourse[0].cname}}</div>',
                    minWidth: 80
                }, {
                    field: 'undoCourse', //课程学分
                    title: '课程学分',
                    templet: '<div>{{d.undoCourse[0].credit}}</div>',
                    width: 100
                }, {
                    field: 'undoCourse', //必修最新分数/选修已得学分
                    title: '必修最新分数/选修已得学分',
                    templet: '<div>{{d.undoCourse[0].score}}</div>',
                    minWidth: 80
                }, {
                    fixed: 'right',
                    width: 150,
                    align: 'center',
                    toolbar: '#barDemo'
                } //这里的toolbar值是模板元素的选择器
                ]
            ],
            //,skin: 'line' //表格风格
            id: 'stuReload',
            even: true,
            page: true, //是否显示分页
            limits: [5, 10, 15],
            limit: 5 //每页默认显示的数量
        });

        // var active = {
        //     reload: function() {
        //         var reload = $('#reload');
        //         //执行重载
        //         table.reload('stuReload', {
        //             url: 'getStuInfoBySid',
        //             method: 'get',
        //             page: {
        //                 curr: 1 //重新从第 1 页开始
        //             },
        //             where: { //类似于 data
        //                 sid: $('#reload').val() //传入搜索的学生id
        //             }
        //         });
        //     }
        // };


        var $ = layui.$,
            active = {
                reload: function () {
                    var demoReload = $('#demoReload');
                    //执行重载
                    table.reload('testReload', {
                        page: {
                            curr: 1 //重新从第 1 页开始
                        },
                        where: {
                            key: {
                                sid: demoReload.val()
                            }
                        }
                    });
                }
            };

        $('#search').on('click', function () {
            var type = $(this).data('type');
            active[type] ? active[type].call(this) : '';
        });
    })
</script>


</body>

</html>